/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.2 		*/
/*  Created On : 15-Jun-2022 9:29:24 PM 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */
CREATE DATABASE QLTC;
USE QLTC;

SET FOREIGN_KEY_CHECKS=0
; 
/* Drop Tables */

DROP TABLE IF EXISTS `ChiTietHSBN` CASCADE
;

DROP TABLE IF EXISTS `CT_DonDH` CASCADE
;

DROP TABLE IF EXISTS `CT_GoiTiem` CASCADE
;

DROP TABLE IF EXISTS `CT_HoaDon` CASCADE
;

DROP TABLE IF EXISTS `DatHang` CASCADE
;

DROP TABLE IF EXISTS `GoiTiem` CASCADE
;

DROP TABLE IF EXISTS `HoaDon` CASCADE
;

DROP TABLE IF EXISTS `HoSoBN` CASCADE
;

DROP TABLE IF EXISTS `KhachHang` CASCADE
;

DROP TABLE IF EXISTS `LichLamViec` CASCADE
;

DROP TABLE IF EXISTS `LichRanh` CASCADE
;

DROP TABLE IF EXISTS `NguoiGiamHo` CASCADE
;

DROP TABLE IF EXISTS `NhanVien` CASCADE
;

DROP TABLE IF EXISTS `TraGop` CASCADE
;

DROP TABLE IF EXISTS `TrungTam` CASCADE
;

DROP TABLE IF EXISTS `Vaccine` CASCADE
;

/* Create Tables */

CREATE TABLE `ChiTietHSBN`
(
	`MaBN` CHAR(10) NOT NULL,
	`NgayKham` DATE NOT NULL,
	`STT` INT NOT NULL,
	`NguoiKham` CHAR(10) NULL,
	`MoTa` VARCHAR(50) NULL,
	CONSTRAINT `PK_ChiTietHSBN` PRIMARY KEY (`MaBN` ASC, `NgayKham` ASC, `STT` ASC)
)

;

CREATE TABLE `CT_DonDH`
(
	`MaDonDH` CHAR(10) NOT NULL,
	`MaVX` CHAR(10) NOT NULL,
	`SoLuong` INT NULL DEFAULT 0,
	`ThanhTien` INT NULL DEFAULT 0,
	CONSTRAINT `PK_CT_DonDH` PRIMARY KEY (`MaDonDH` ASC, `MaVX` ASC)
)

;

CREATE TABLE `CT_GoiTiem`
(
	`MaGT` CHAR(10) NOT NULL,
	`MaVX` CHAR(10) NOT NULL,
	`SoMui` INT NULL DEFAULT 0,
	CONSTRAINT `PK_CT_GoiTiem` PRIMARY KEY (`MaGT` ASC, `MaVX` ASC)
)

;

CREATE TABLE `CT_HoaDon`
(
	`MaHD` CHAR(10) NOT NULL,
	`MaGT` CHAR(10) NOT NULL,
	`SoLuong` INT NULL DEFAULT 0,
	`ThanhTien` INT NULL DEFAULT 0,
	CONSTRAINT `PK_CT_HoaDon` PRIMARY KEY (`MaHD` ASC, `MaGT` ASC)
)

;

CREATE TABLE `DatHang`
(
	`MaDonDH` CHAR(10) NOT NULL,
	`MaHD` CHAR(10) NULL,
	`TongTien` INT NULL DEFAULT 0,
    `KiemDuyet` BOOL DEFAULT FALSE,
	CONSTRAINT `PK_DatHang` PRIMARY KEY (`MaDonDH` ASC)
)

;

CREATE TABLE `GoiTiem`
(
	`MaGT` CHAR(10) NOT NULL,
	`TenGT` VARCHAR(50) NULL,
	`DonGia` INT NULL DEFAULT 0,
	CONSTRAINT `PK_GoiTiem` PRIMARY KEY (`MaGT` ASC)
)

;

CREATE TABLE `HoaDon`
(
	`MaHD` CHAR(10) NOT NULL,
	`LoaiHD` VARCHAR(50) NULL,
	`MaKH` CHAR(10) NULL,
	`NgayHen` DATE NULL,
	`NguoiLap` CHAR(10) NULL,
	`TongTien` INT NULL DEFAULT 0,
	CONSTRAINT `PK_HoaDon` PRIMARY KEY (`MaHD` ASC)
)

;

CREATE TABLE `HoSoBN`
(
	`MaBN` CHAR(10) NOT NULL,
	`NgayKham` DATE NOT NULL,
	`NguoiTiem` CHAR(10) NULL,
	CONSTRAINT `PK_HoSoBN` PRIMARY KEY (`MaBN` ASC, `NgayKham` ASC)
)

;

CREATE TABLE `KhachHang`
(
	`MaKH` CHAR(10) NOT NULL,
	`HoTenKH` VARCHAR(50) NULL,
	`NgaySinh` DATE NULL,
	`GioiTinh` BOOL NULL,
	`DiaChi` VARCHAR(100) NULL,
    `CMND` VARCHAR(12) NULL,
	`SDT` VARCHAR(50) NULL,
	CONSTRAINT `PK_KhachHang` PRIMARY KEY (`MaKH` ASC)
)

;

CREATE TABLE `LichLamViec`
(
	`Ngay` DATE NOT NULL,
	`Ca` VARCHAR(10) NOT NULL,
	`MaNV` CHAR(10) NULL,
	`ViTri` VARCHAR(50) NULL,
	CONSTRAINT `PK_LichLamViec` PRIMARY KEY (`Ngay` ASC, `Ca` ASC)
)

;

CREATE TABLE `LichRanh`
(
	`MaNV` CHAR(10) NOT NULL,
	`Ngay` DATE NOT NULL,
	`Ca` VARCHAR(10) NOT NULL,
	CONSTRAINT `PK_LichRanh` PRIMARY KEY (`MaNV` ASC, `Ngay` ASC, `Ca` ASC)
)

;

CREATE TABLE `NguoiGiamHo`
(
	`MaKH` CHAR(10) NOT NULL,
	`NguoiGiamHo` CHAR(10) NOT NULL,
	`QuanHe` VARCHAR(50) NULL,
	CONSTRAINT `PK_NguoiGiamHo` PRIMARY KEY (`MaKH` ASC, `NguoiGiamHo` ASC)
)

;

CREATE TABLE `NhanVien`
(
	`MaNV` CHAR(10) NOT NULL,
	`MaTT` CHAR(10) NOT NULL,
	`HoTen` VARCHAR(50) NULL,
	`NgaySinh` DATE NULL,
	`ViTri` VARCHAR(50) NULL,
	CONSTRAINT `PK_NhanVien` PRIMARY KEY (`MaNV` ASC)
)

;

CREATE TABLE `TraGop`
(
	`MaHD` CHAR(10) NOT NULL,
	`STT` CHAR(10) NOT NULL,
	`SoTien` INT NULL DEFAULT 0,
	CONSTRAINT `PK_TraGop` PRIMARY KEY (`MaHD` ASC, `STT` ASC)
)

;

CREATE TABLE `TrungTam`
(
	`MaTT` CHAR(10) NOT NULL,
	`TenTT` VARCHAR(50) NULL,
	CONSTRAINT `PK_TrungTam` PRIMARY KEY (`MaTT` ASC)
)

;

CREATE TABLE `Vaccine`
(
	`MaVX` CHAR(10) NOT NULL,
	`TenVX` VARCHAR(50) NULL,
    `NhaSX` VARCHAR(50) NULL,
    `GiaMua` INT NULL DEFAULT 0,
	`HanSuDung` DATE NULL,
    `SoLuongTon` INT NULL DEFAULT 0,
	CONSTRAINT `PK_Vaccine` PRIMARY KEY (`MaVX` ASC)
)

;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `ChiTietHSBN` 
 ADD INDEX `IXFK_ChiTietHSBN_HoSoBN` (`MaBN` ASC, `NgayKham` ASC)
;

ALTER TABLE `ChiTietHSBN` 
 ADD INDEX `IXFK_ChiTietHSBN_NhanVien` (`NguoiKham` ASC)
;

ALTER TABLE `CT_DonDH` 
 ADD INDEX `IXFK_CT_DonDH_DatHang` (`MaDonDH` ASC)
;

ALTER TABLE `CT_DonDH` 
 ADD INDEX `IXFK_CT_DonDH_Vaccine` (`MaVX` ASC)
;

ALTER TABLE `CT_GoiTiem` 
 ADD INDEX `IXFK_CT_GoiTiem_GoiTiem` (`MaGT` ASC)
;

ALTER TABLE `CT_GoiTiem` 
 ADD INDEX `IXFK_CT_GoiTiem_Vaccine` (`MaVX` ASC)
;

ALTER TABLE `CT_HoaDon` 
 ADD INDEX `IXFK_CT_HoaDon_GoiTiem` (`MaGT` ASC)
;

ALTER TABLE `CT_HoaDon` 
 ADD INDEX `IXFK_CT_HoaDon_HoaDon` (`MaHD` ASC)
;

ALTER TABLE `DatHang` 
 ADD INDEX `IXFK_DatHang_HoaDon` (`MaHD` ASC)
;

ALTER TABLE `HoaDon` 
 ADD INDEX `IXFK_HoaDon_KhachHang` (`MaKH` ASC)
;

ALTER TABLE `HoaDon` 
 ADD INDEX `IXFK_HoaDon_NhanVien` (`NguoiLap` ASC)
;

ALTER TABLE `HoSoBN` 
 ADD INDEX `IXFK_HoSoBN_KhachHang` (`MaBN` ASC)
;

ALTER TABLE `HoSoBN` 
 ADD INDEX `IXFK_HoSoBN_NhanVien` (`NguoiTiem` ASC)
;

ALTER TABLE `LichLamViec` 
 ADD INDEX `IXFK_LichLamViec_NhanVien` (`MaNV` ASC)
;

ALTER TABLE `LichRanh` 
 ADD INDEX `IXFK_LichRanh_NhanVien` (`MaNV` ASC)
;

ALTER TABLE `NguoiGiamHo` 
 ADD INDEX `IXFK_NguoiGiamHo_KhachHang` (`MaKH` ASC)
;

ALTER TABLE `NguoiGiamHo` 
 ADD INDEX `IXFK_NguoiGiamHo_KhachHang_02` (`NguoiGiamHo` ASC)
;

ALTER TABLE `NhanVien` 
 ADD INDEX `IXFK_NhanVien_TrungTam` (`MaTT` ASC)
;

ALTER TABLE `TraGop` 
 ADD INDEX `IXFK_TraGop_HoaDon` (`MaHD` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `ChiTietHSBN` 
 ADD CONSTRAINT `FK_ChiTietHSBN_HoSoBN`
	FOREIGN KEY (`MaBN`, `NgayKham`) REFERENCES `HoSoBN` (`MaBN`,`NgayKham`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `ChiTietHSBN` 
 ADD CONSTRAINT `FK_ChiTietHSBN_NhanVien`
	FOREIGN KEY (`NguoiKham`) REFERENCES `NhanVien` (`MaNV`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_DonDH` 
 ADD CONSTRAINT `FK_CT_DonDH_DatHang`
	FOREIGN KEY (`MaDonDH`) REFERENCES `DatHang` (`MaDonDH`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_DonDH` 
 ADD CONSTRAINT `FK_CT_DonDH_Vaccine`
	FOREIGN KEY (`MaVX`) REFERENCES `Vaccine` (`MaVX`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_GoiTiem` 
 ADD CONSTRAINT `FK_CT_GoiTiem_GoiTiem`
	FOREIGN KEY (`MaGT`) REFERENCES `GoiTiem` (`MaGT`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_GoiTiem` 
 ADD CONSTRAINT `FK_CT_GoiTiem_Vaccine`
	FOREIGN KEY (`MaVX`) REFERENCES `Vaccine` (`MaVX`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_HoaDon` 
 ADD CONSTRAINT `FK_CT_HoaDon_GoiTiem`
	FOREIGN KEY (`MaGT`) REFERENCES `GoiTiem` (`MaGT`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `CT_HoaDon` 
 ADD CONSTRAINT `FK_CT_HoaDon_HoaDon`
	FOREIGN KEY (`MaHD`) REFERENCES `HoaDon` (`MaHD`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `DatHang` 
 ADD CONSTRAINT `FK_DatHang_HoaDon`
	FOREIGN KEY (`MaHD`) REFERENCES `HoaDon` (`MaHD`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `HoaDon` 
 ADD CONSTRAINT `FK_HoaDon_KhachHang`
	FOREIGN KEY (`MaKH`) REFERENCES `KhachHang` (`MaKH`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `HoaDon` 
 ADD CONSTRAINT `FK_HoaDon_NhanVien`
	FOREIGN KEY (`NguoiLap`) REFERENCES `NhanVien` (`MaNV`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `HoSoBN` 
 ADD CONSTRAINT `FK_HoSoBN_KhachHang`
	FOREIGN KEY (`MaBN`) REFERENCES `KhachHang` (`MaKH`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `HoSoBN` 
 ADD CONSTRAINT `FK_HoSoBN_NhanVien`
	FOREIGN KEY (`NguoiTiem`) REFERENCES `NhanVien` (`MaNV`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `LichLamViec` 
 ADD CONSTRAINT `FK_LichLamViec_NhanVien`
	FOREIGN KEY (`MaNV`) REFERENCES `NhanVien` (`MaNV`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `LichRanh` 
 ADD CONSTRAINT `FK_LichRanh_NhanVien`
	FOREIGN KEY (`MaNV`) REFERENCES `NhanVien` (`MaNV`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `NguoiGiamHo` 
 ADD CONSTRAINT `FK_NguoiGiamHo_KhachHang`
	FOREIGN KEY (`MaKH`) REFERENCES `KhachHang` (`MaKH`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `NguoiGiamHo` 
 ADD CONSTRAINT `FK_NguoiGiamHo_KhachHang_02`
	FOREIGN KEY (`NguoiGiamHo`) REFERENCES `KhachHang` (`MaKH`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `TraGop` 
 ADD CONSTRAINT `FK_TraGop_HoaDon`
	FOREIGN KEY (`MaHD`) REFERENCES `HoaDon` (`MaHD`) ON DELETE No Action ON UPDATE No Action
;

SET FOREIGN_KEY_CHECKS=1
; 
